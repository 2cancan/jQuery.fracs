(function(g){var c=function(k,j,i,h){this.left=k;this.top=j;this.width=i;this.height=h;this.right=k+i;this.bottom=j+h;this.equals=function(l){return this.left===l.left&&this.top===l.top&&this.width===l.width&&this.height===l.height};this.area=function(){return this.width*this.height};this.intersection=function(p){var r=Math.max(this.left,p.left);var n=Math.min(this.right,p.right);var q=Math.max(this.top,p.top);var m=Math.min(this.bottom,p.bottom);var o=n-r;var l=m-q;if(o<0||l<0){return undefined}return new c(r,q,o,l)}};var f=function(j,k,h,i){this.rect=j;this.visible=k;this.viewport=h;this.possible=i;this.equals=function(l){return this.fracsEqual(l)&&this.rectsEqual(l)};this.fracsEqual=function(l){return this.visible===l.visible&&this.viewport===l.viewport&&this.possible===l.possible};this.rectsEqual=function(l){return this.rect.equals(l.rect)}};var a=function(h,i){this.target=h;this.callback=i;this.prevFracs=undefined;this.rect=function(){return e.rect(this.target)};this.fracs=function(){return e.fracs(e.rect(this.target),e.viewport())};this.check=function(){var j=this.fracs();if(this.prevFracs===undefined||!this.prevFracs.fracsEqual(j)){this.callback.call(this.target,j,this.prevFracs);this.prevFracs=j}};this.checkProxy=g.proxy(this.check,this)};var d="fracs";var e={viewport:function(){var h=g(window);return new c(h.scrollLeft(),h.scrollTop(),h.width(),h.height())},rect:function(i){var h=g(i);var j=h.offset();return new c(j.left,j.top,h.outerWidth(),h.outerHeight())},fracs:function(k,i){var l=k.intersection(i);if(l===undefined){return new f(undefined,0,0,0)}var h=l.area();var j=Math.min(k.width,i.width)*Math.min(k.height,i.height);return new f(l,1*h/k.area(),1*h/i.area(),1*h/j)},round:function(i,h){h=h||3;return Math.round(i*Math.pow(10,h))/Math.pow(10,h)}};var b={init:function(h){return this.each(function(){var i=new a(this,h);g(this).data(d,i);g(window).bind("scroll",i.checkProxy).bind("resize",i.checkProxy);i.check()})},destroy:function(){return this.each(function(){var i=g(this);var h=i.data(d);i.removeData(d);g(window).unbind("scroll",h.checkProxy).unbind("resize",h.checkProxy)})},check:function(){return this.each(function(){var h=g(this).data(d);if(h){h.check()}})},current:function(){return e.fracs(e.rect(this.get(0)),e.viewport())},rect:function(){return e.rect(this.get(0))}};g[d]=e;g.fn[d]=function(h){if(b[h]){return b[h].apply(this,Array.prototype.slice.call(arguments,1))}else{if(!h){return b.current.apply(this,arguments)}else{if(h instanceof Function){return b.init.apply(this,arguments)}else{g.error("Method "+h+" does not exist on jQuery."+d)}}}}})(jQuery);